<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bavaria State ‚Äì Juristische Staatspr√ºfung</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{margin:0;font-family:Arial;background:#0b1220;color:white;}
header{text-align:center;padding:20px;}
header img{width:260px;}
.container{max-width:1100px;margin:auto;background:#111827;padding:30px;border-radius:12px;}
.question{background:#0f172a;padding:15px;border-radius:8px;margin:20px 0;}
button{padding:10px 20px;background:#2563eb;color:white;border:none;border-radius:6px;cursor:pointer;}
button:hover{background:#1d4ed8;}
.sticky-timer{
position:fixed;
top:0;
right:0;
background:#111827;
padding:15px 25px;
font-size:18px;
font-weight:bold;
color:#f87171;
border-bottom-left-radius:12px;
z-index:999;
}
.hidden{display:none;}
</style>
</head>
<body>

<div class="sticky-timer">
Zeit: <span id="time">15:00</span>
</div>

<header>
<img src="logo.png">
<h1>Bavaria State ‚Äì Juristische Staatspr√ºfung</h1>
</header>

<div class="container">

<label>RP-Name</label>
<input type="text" id="rpname">

<label>Kanzlei</label>
<input type="text" id="kanzlei">

<div id="quiz"></div>

<button id="submitBtn" onclick="submitExam()">Pr√ºfung abgeben</button>

<div id="result" class="hidden"></div>

</div>

<script>

const TOTAL_QUESTIONS = 20;
const PASS_PERCENTAGE = 80;
const TIME_LIMIT = 15 * 60;

let timeLeft = TIME_LIMIT;
let submitted = false;
let currentQuestions = [];
let timerInterval;

//////////////////////////////////////////////////////
// 100 FRAGEN ‚Äì MIXED ANSWERS
//////////////////////////////////////////////////////

const questionPool = [

{q:"Was sch√ºtzt ¬ß1?",a:["Eigentum","Menschenw√ºrde","Staatsgewalt","Polizei"],c:1},
{q:"Was verbietet ¬ß1 ausdr√ºcklich?",a:["Steuern","Erniedrigung","F√ºhrerscheinpflicht","Insolvenz"],c:1},
{q:"Was regelt ¬ß2?",a:["Gleichheit vor dem Gesetz","Waffenrecht","Insolvenz","Notstand"],c:0},
{q:"Wann darf Eigentum entzogen werden (¬ß4)?",a:["Nur auf gesetzlicher Grundlage","Bei Verdacht","Immer","Nie"],c:0},
{q:"Wie hei√üt die Gewaltenteilung (¬ß5)?",a:["Legislative, Exekutive, Judikative","Polizei & Gericht","Milit√§r","Rat & K√∂nig"],c:0},
{q:"Maximale Festhaltung (¬ß31)?",a:["60 Minuten","120 Minuten","240 Minuten","Unbegrenzt"],c:1},
{q:"Alkoholgrenze (¬ß44)?",a:["1,0‚Ä∞","0,3‚Ä∞","0,5‚Ä∞","0,8‚Ä∞"],c:2},
{q:"H√∂chstgeschwindigkeit innerorts (¬ß43)?",a:["100 km/h","80 km/h","50 km/h","130 km/h"],c:1},
{q:"Was ist Betrug (¬ß21)?",a:["T√§uschung zur Erlangung eines Verm√∂gensvorteils","Diebstahl","Raub","Unfall"],c:0},
{q:"Was ist Raub (¬ß15)?",a:["Gewaltloser Diebstahl","Einbruch","Diebstahl mit Gewalt","Fahrl√§ssigkeit"],c:2},
{q:"Was ist Mord (¬ß11)?",a:["Fahrl√§ssige T√∂tung","Heimt√ºckische T√∂tung","Notwehr","Unfall"],c:1},
{q:"Was ist Amtsmissbrauch (¬ß25)?",a:["Missbrauch staatlicher Position","Bestechung","Verkehrsdelikt","Insolvenz"],c:0},
{q:"Wann darf Zwang angewendet werden (¬ß33)?",a:["Wenn mildere Mittel nicht ausreichen","Immer","Nie","Bei jeder Kontrolle"],c:0},
{q:"Was ist Freiheitsberaubung (¬ß12)?",a:["Unrechtm√§√üiges Festhalten","Verurteilung","Bu√ügeld","Lizenzentzug"],c:0},
{q:"Was ist Erpressung (¬ß22)?",a:["Drohung zur Erzwingung von Geld","Diebstahl","Betrug","Verkehrsversto√ü"],c:0},
{q:"Welche Strafe kennt ¬ß26?",a:["Geldstrafe","Nur Bew√§hrung","Nur Haft","Keine"],c:0},
{q:"Was ist Widerstand (¬ß17)?",a:["Gewalt gegen Amtstr√§ger","Beleidigung","Flucht","Anzeige"],c:0},
{q:"Waffenbesitz erlaubt mit (¬ß35)?",a:["WBK","Personalausweis","F√ºhrerschein","Steuernummer"],c:0},
{q:"Wie entsteht ein Vertrag (¬ß46)?",a:["Angebot und Annahme","Zeuge","Polizei","Gerichtsbeschluss"],c:0},
{q:"Wer erh√§lt Grundsicherung (¬ß54)?",a:["Bed√ºrftige","Jeder","Nur Beamte","Niemand"],c:0}

];

// üëâ Du kannst diesen Pool problemlos auf 100‚Äì120 Fragen erweitern.

//////////////////////////////////////////////////////

function shuffle(array){
for (let i = array.length - 1; i > 0; i--) {
const j = Math.floor(Math.random() * (i + 1));
[array[i], array[j]] = [array[j], array[i]];
}
return array;
}

function loadQuiz(){

if(localStorage.getItem("examSubmitted")){
document.getElementById("result").classList.remove("hidden");
document.getElementById("result").innerHTML=localStorage.getItem("examResult");
document.getElementById("submitBtn").disabled=true;
return;
}

let selected = shuffle([...questionPool]).slice(0,TOTAL_QUESTIONS);

currentQuestions = selected;

const quiz=document.getElementById("quiz");
quiz.innerHTML="";

selected.forEach((item,index)=>{

let answers = shuffle([...item.a]);
let correctIndex = answers.indexOf(item.a[item.c]);
item.correctIndex = correctIndex;

quiz.innerHTML+=`
<div class='question'>
<p>${index+1}. ${item.q}</p>
${answers.map((ans,i)=>`
<label>
<input type="radio" name="q${index}" value="${i}"> ${ans}
</label><br>
`).join("")}
</div>`;
});
}

function submitExam(){

if(submitted) return;
submitted = true;

clearInterval(timerInterval);

let score=0;

currentQuestions.forEach((q,i)=>{
let chosen=document.querySelector(`input[name=q${i}]:checked`);
if(chosen && parseInt(chosen.value)===q.correctIndex) score++;
});

let percent=Math.round((score/TOTAL_QUESTIONS)*100);
let status = percent>=PASS_PERCENTAGE ? "Bestanden" : "Nicht bestanden";

let resultHTML=`<h2>${status} (${percent}%)</h2>`;

document.getElementById("result").classList.remove("hidden");
document.getElementById("result").innerHTML=resultHTML;

localStorage.setItem("examSubmitted",true);
localStorage.setItem("examResult",resultHTML);

if(percent>=PASS_PERCENTAGE){
generateCertificate(percent);
}
}

function generateCertificate(score){
const { jsPDF } = window.jspdf;
const doc = new jsPDF();
doc.setFontSize(22);
doc.text("Bavaria State",70,20);
doc.setFontSize(16);
doc.text("Juristische Staatszulassung",60,35);
doc.text("Name: "+rpname.value,20,60);
doc.text("Kanzlei: "+kanzlei.value,20,75);
doc.text("Ergebnis: "+score+"%",20,90);
doc.save("Bavaria_Staatszertifikat.pdf");
}

timerInterval=setInterval(()=>{
timeLeft--;
let min=Math.floor(timeLeft/60);
let sec=timeLeft%60;
document.getElementById("time").textContent=
`${min}:${sec<10?'0':''}${sec}`;
if(timeLeft<=0) submitExam();
},1000);

loadQuiz();

</script>
</body>
</html>
